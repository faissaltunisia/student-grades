<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>منصة مدرسة المروج | ديني قيمي</title>
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700&family=Amiri:wght@700&display=swap" rel="stylesheet">
    <style>
        :root { --royal-green: #004d40; --gold: #D4AF37; --bg: #fdfaf0; }
        body { font-family: 'Cairo', sans-serif; background: var(--bg); margin: 0; padding-bottom: 100px; }
        
        header { 
            background: linear-gradient(135deg, var(--royal-green), #002d26);
            color: white; padding: 20px; text-align: center; border-bottom: 5px solid var(--gold);
        }

        .container { padding: 15px; max-width: 600px; margin: auto; }

        .quran-card {
            background: white; border-radius: 25px; padding: 25px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1); border: 2px solid var(--gold);
            text-align: center;
        }

        .sura-text {
            font-family: 'Amiri'; font-size: 1.8rem; line-height: 2.5;
            text-align: justify; direction: rtl; margin-bottom: 25px;
        }

        /* الآية النشطة */
        .ayah { padding: 2px 6px; border-radius: 8px; transition: 0.3s; display: inline; }
        .active { background: var(--gold); color: white; box-shadow: 0 4px 10px rgba(212, 175, 55, 0.4); }

        /* أزرار التحكم السفلية */
        .player-controls {
            position: fixed; bottom: 20px; left: 50%; transform: translateX(-50%);
            width: 90%; max-width: 450px; background: white; 
            padding: 15px; border-radius: 50px; border: 2px solid var(--gold);
            display: flex; align-items: center; justify-content: space-between;
            box-shadow: 0 10px 25px rgba(0,0,0,0.2); z-index: 1000;
        }

        .play-btn {
            background: var(--royal-green); color: white; border: none;
            width: 55px; height: 55px; border-radius: 50%; font-size: 1.2rem;
            cursor: pointer; display: flex; align-items: center; justify-content: center;
        }
    </style>
</head>
<body>

<header>
    <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/4/4e/Emblem_of_Oman.svg/1200px-Emblem_of_Oman.svg.png" style="height:50px; margin-bottom:10px;">
    <h1 style="margin:0; font-size:1.1rem; color:var(--gold);">مدرسة المروج للتعليم الأساسي</h1>
</header>

<div class="container">
    <div class="quran-card">
        <h2 style="color:var(--royal-green); font-family:'Amiri';">سورة المعارج</h2>
        <div id="mushaf" class="sura-text">
            </div>
    </div>
</div>

<div class="player-controls">
    <button class="play-btn" onclick="handlePlayPause()" id="btnUI">▶</button>
    <div style="flex:1; padding: 0 15px; text-align: right;">
        <div id="statusLabel" style="font-size: 0.8rem; font-weight: bold; color: var(--royal-green);">اضغط للتشغيل</div>
        <div style="width:100%; height:4px; background:#eee; margin-top:5px; border-radius:2px;">
            <div id="fillBar" style="width:0%; height:100%; background:var(--gold);"></div>
        </div>
    </div>
</div>

<audio id="myAudio" preload="auto">
    <source src="https://download.quranicaudio.com/quran/ahmed_sa3d_al-ghaamidi/070.mp3" type="audio/mpeg">
</audio>

<script>
    const suraData = [
        { id: 1, text: "سَأَلَ سَائِلٌ بِعَذَابٍ وَاقِعٍ ﴿١﴾", start: 0, end: 5 },
        { id: 2, text: "لِّلْكَافِرِينَ لَيْسَ لَهُ دَافِعٌ ﴿٢﴾", start: 5, end: 11 },
        { id: 3, text: "مِّنَ اللَّهِ ذِي الْمَعَارِجِ ﴿٣﴾", start: 11, end: 16 },
        { id: 4, text: "تَعْرُجُ الْمَلَائِكَةُ وَالرُّوحُ إِلَيْهِ فِي يَوْمٍ كَانَ مِقْدَارُهُ خَمْسِينَ أَلْفَ سَنَةٍ ﴿٤﴾", start: 16, end: 28 },
        { id: 5, text: "فَاصْبِرْ صَبْرًا جَمِيلًا ﴿٥﴾", start: 28, end: 32 }
    ];

    const audio = document.getElementById('myAudio');
    const btnUI = document.getElementById('btnUI');
    const statusLabel = document.getElementById('statusLabel');

    // عرض الآيات
    document.getElementById('mushaf').innerHTML = suraData.map(a => `<span class="ayah" id="a-${a.id}">${a.text}</span>`).join(' ');

    function handlePlayPause() {
        if (audio.paused) {
            // محاولة التشغيل المباشر (تكسر حماية المتصفح)
            audio.play().then(() => {
                btnUI.innerText = "⏸";
                statusLabel.innerText = "جاري التلاوة والتتبع...";
            }).catch(error => {
                console.log("الارتباط الصوتي يحتاج لضغط إضافي");
                // محاولة بديلة
                audio.load();
                audio.play();
            });
        } else {
            audio.pause();
            btnUI.innerText = "▶";
            statusLabel.innerText = "تم الإيقاف مؤقتاً";
        }
    }

    // محرك المزامنة
    audio.ontimeupdate = () => {
        const now = audio.currentTime;
        
        // تحديث الشريط
        const progress = (audio.currentTime / audio.duration) * 100;
        document.getElementById('fillBar').style.width = progress + "%";

        // تلوين الآية
        suraData.forEach(a => {
            const el = document.getElementById(`a-${a.id}`);
            if (now >= a.start && now < a.end) {
                document.querySelectorAll('.ayah').forEach(i => i.classList.remove('active'));
                el.classList.add('active');
            }
        });
    };
</script>

</body>
</html>
