<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ù…Ù†ØµØ© Ù…Ø¯Ø±Ø³Ø© Ø§Ù„Ù…Ø±ÙˆØ¬ | ÙÙŠØµÙ„ Ø§Ù„Ø¹Ø±ÙŠØ¨ÙŠ</title>
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700;900&family=Amiri:wght@700&display=swap" rel="stylesheet">
    <style>
        :root { --royal-green: #004d40; --gold: #D4AF37; --bg: #f4f1ea; }
        * { box-sizing: border-box; }
        body { font-family: 'Cairo', sans-serif; background: var(--bg); margin: 0; }

        header {
            position: fixed; top: 0; width: 100%; z-index: 1000;
            background: rgba(0, 77, 64, 0.95); backdrop-filter: blur(10px);
            border-bottom: 4px solid var(--gold); padding: 10px 20px;
            display: flex; justify-content: space-between; align-items: center; color: white;
        }
        .oman-logo { height: 40px; filter: brightness(0) invert(1); }

        main { margin-top: 100px; padding: 20px; max-width: 1100px; margin-left: auto; margin-right: auto; }

        .card-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 20px; }
        .main-card {
            background: white; border-radius: 20px; padding: 25px; text-align: center;
            border: 1px solid rgba(212,175,55,0.3); box-shadow: 0 5px 15px rgba(0,0,0,0.05);
            cursor: pointer; transition: 0.3s;
        }
        .main-card:hover { transform: translateY(-5px); border-color: var(--gold); }

        /* Ù…Ø´ØºÙ„ Ø§Ù„ÙÙŠØ¯ÙŠÙˆ Ø§Ù„Ø³ÙŠÙ†Ù…Ø§Ø¦ÙŠ */
        #video-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.95); display: none; z-index: 9999;
            justify-content: center; align-items: center; flex-direction: column;
        }
        .video-box { width: 90%; max-width: 800px; background: #000; border: 3px solid var(--gold); border-radius: 15px; overflow: hidden; }

        /* Ù…Ø´ØºÙ„ Ø§Ù„ØµÙˆØª Ø§Ù„Ø³ÙÙ„ÙŠ */
        #audioBar {
            position: fixed; bottom: 20px; left: 50%; transform: translateX(-50%);
            width: 90%; max-width: 500px; background: white; border-radius: 50px;
            padding: 15px 25px; border: 3px solid var(--gold); display: none;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2); z-index: 2000; align-items: center; gap: 15px;
        }
        .btn-play { background: var(--royal-green); color: white; border: none; width: 45px; height: 45px; border-radius: 50%; cursor: pointer; font-size: 1.2rem; }

        .btn-royal { background: var(--royal-green); color: var(--gold); border: 2px solid var(--gold); padding: 10px 20px; border-radius: 30px; cursor: pointer; font-weight: bold; margin: 5px; }

        .mushaf-view { background: white; border-radius: 20px; padding: 30px; border: 2px solid var(--gold); text-align: center; margin-top: 20px; line-height: 2.5; }
        .word { font-family: 'Amiri'; font-size: 2rem; padding: 0 5px; color: #333; }
        .active-word { color: var(--gold); font-weight: bold; transform: scale(1.1); display: inline-block; }

        .view { display: none; }
        .active-view { display: block; }
    </style>
</head>
<body>

<header>
    <div><h1 style="margin:0; font-size:1rem;">Ù…Ø¯Ø±Ø³Ø© Ø§Ù„Ù…Ø±ÙˆØ¬ Ù„Ù„ØªØ¹Ù„ÙŠÙ… Ø§Ù„Ø£Ø³Ø§Ø³ÙŠ</h1></div>
    <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/4/4e/Emblem_of_Oman.svg/1200px-Emblem_of_Oman.svg.png" class="oman-logo">
</header>

<main>
    <section id="home" class="view active-view">
        <div class="card-grid" id="grades-grid"></div>
    </section>

    <section id="terms" class="view">
        <button class="btn-royal" onclick="showView('home')">â¬… Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</button>
        <div class="card-grid">
            <div class="main-card" onclick="renderSuras(1)"><h3>Ø§Ù„ÙØµÙ„ Ø§Ù„Ø¯Ø±Ø§Ø³ÙŠ Ø§Ù„Ø£ÙˆÙ„</h3></div>
            <div class="main-card" onclick="renderSuras(2)"><h3>Ø§Ù„ÙØµÙ„ Ø§Ù„Ø¯Ø±Ø§Ø³ÙŠ Ø§Ù„Ø«Ø§Ù†ÙŠ</h3></div>
        </div>
    </section>

    <section id="suras" class="view">
        <button class="btn-royal" onclick="showView('terms')">â¬… Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„ÙØµÙˆÙ„</button>
        <div id="suras-list"></div>
    </section>

    <section id="reading" class="view">
        <button class="btn-royal" onclick="exitReading()">â¬… Ø¥Ù†Ù‡Ø§Ø¡ ÙˆØ§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„Ø³ÙˆØ±</button>
        <div class="mushaf-view" id="mushaf-content"></div>
    </section>
</main>

<div id="video-overlay">
    <div class="video-box" id="player-container">
        <div id="yt-player"></div>
    </div>
    <button class="btn-royal" onclick="closeVideo()" style="background:#d32f2f; color:white; border:none; margin-top:20px; padding:15px 40px; font-size:1.1rem;">âŒ Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„ÙÙŠØ¯ÙŠÙˆ ÙˆØ§Ù„Ø±Ø¬ÙˆØ¹ Ù„Ù„Ø³ÙˆØ±Ø©</button>
</div>

<div id="audioBar">
    <button class="btn-play" onclick="toggleAudio()" id="pBtn">â–¶</button>
    <div style="flex:1">
        <div id="audio-title" style="font-weight:bold; color:var(--royal-green); font-size:0.8rem;"></div>
        <div style="width:100%; height:5px; background:#eee; border-radius:5px; margin-top:5px; overflow:hidden;">
            <div id="a-prog" style="width:0%; height:100%; background:var(--gold);"></div>
        </div>
    </div>
</div>

<audio id="audioEngine"></audio>

<script src="https://www.youtube.com/iframe_api"></script>

<script>
    const curriculum = {
        5: { 1: [{n: "Ø§Ù„Ù…Ø±Ø³Ù„Ø§Øª", id: "077", vid: "dQw4w9WgXcQ"}], 2: [{n: "Ø§Ù„Ù‚ÙŠØ§Ù…Ø©", id: "075", vid: "dQw4w9WgXcQ"}] },
        6: { 1: [{n: "Ø§Ù„Ù…Ø¯Ø«Ø±", id: "074", vid: "dQw4w9WgXcQ"}], 2: [{n: "Ù†ÙˆØ­", id: "071", vid: "dQw4w9WgXcQ"}] },
        // ... (Ø¨Ù‚ÙŠØ© Ø§Ù„ØµÙÙˆÙ Ø¨Ù†ÙØ³ Ø§Ù„Ù†Ù…Ø·)
    };

    let selectedGrade, player;
    const audioEngine = document.getElementById('audioEngine');

    // Ø¥Ù†Ø´Ø§Ø¡ Ø¨Ø·Ø§Ù‚Ø§Øª Ø§Ù„ØµÙÙˆÙ
    const grid = document.getElementById('grades-grid');
    for(let i=5; i<=12; i++) {
        grid.innerHTML += `<div class="main-card" onclick="selectGrade(${i})"><h2>Ø§Ù„ØµÙ ${i}</h2><p>Ø§Ù„Ù…Ù†Ù‡Ø¬ Ø§Ù„Ø¹Ù…Ø§Ù†ÙŠ</p></div>`;
    }

    function showView(id) {
        document.querySelectorAll('.view').forEach(v => v.classList.remove('active-view'));
        document.getElementById(id).classList.add('active-view');
        window.scrollTo(0,0);
    }

    function selectGrade(g) { selectedGrade = g; showView('terms'); }

    function renderSuras(term) {
        const list = document.getElementById('suras-list');
        list.innerHTML = `<h2 style="text-align:center; color:var(--royal-green)">Ø³ÙˆØ± Ø§Ù„ÙØµÙ„ ${term}</h2>`;
        const suras = curriculum[selectedGrade] ? curriculum[selectedGrade][term] : [{n: "Ø³ÙˆØ±Ø© ØªØ¬Ø±ÙŠØ¨ÙŠØ©", id: "001", vid: "dQw4w9WgXcQ"}];
        suras.forEach(s => {
            list.innerHTML += `<div class="main-card" style="margin-bottom:15px; display:flex; justify-content:space-between; align-items:center;">
                <h3>Ø³ÙˆØ±Ø© ${s.n}</h3>
                <div>
                    <button class="btn-royal" onclick="startReading('${s.n}', '${s.id}')">ğŸ”Š ØªÙ„Ø§ÙˆØ©</button>
                    <button class="btn-royal" style="background:var(--gold); color:white;" onclick="openVideo('${s.vid}')">ğŸ“º ÙÙŠØ¯ÙŠÙˆ</button>
                </div>
            </div>`;
        });
        showView('suras');
    }

    // --- Ø¥ØµÙ„Ø§Ø­ Ù…Ø´ÙƒÙ„Ø© Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„ÙÙŠØ¯ÙŠÙˆ ---
    function openVideo(vidId) {
        document.getElementById('video-overlay').style.display = 'flex';
        if (player && typeof player.loadVideoById === 'function') {
            player.loadVideoById(vidId);
        } else {
            player = new YT.Player('yt-player', {
                height: '360', width: '100%', videoId: vidId,
                playerVars: {'autoplay': 1, 'controls': 1},
                events: { 'onStateChange': (e) => { if(e.data === 0) closeVideo(); } }
            });
        }
    }

    function closeVideo() {
        // Ø¥ÙŠÙ‚Ø§Ù Ø§Ù„ÙÙŠØ¯ÙŠÙˆ ØªÙ…Ø§Ù…Ø§Ù‹
        if (player && typeof player.stopVideo === 'function') {
            player.stopVideo();
        }
        // Ø¥Ø®ÙØ§Ø¡ Ø§Ù„ÙˆØ§Ø¬Ù‡Ø©
        document.getElementById('video-overlay').style.display = 'none';
        // Ù…Ø³Ø­ Ù…Ø­ØªÙˆÙ‰ Ø§Ù„ÙÙŠØ¯ÙŠÙˆ Ù„Ø¶Ù…Ø§Ù† Ø§Ù„ØªÙˆÙ‚Ù ÙÙŠ Ø¨Ø¹Ø¶ Ø§Ù„Ù…ØªØµÙØ­Ø§Øª
        document.getElementById('yt-player').innerHTML = ""; 
        // Ø¥Ø¹Ø§Ø¯Ø© ØªÙ‡ÙŠØ¦Ø© Ø§Ù„Ù…ÙƒØ§Ù† Ù„Ù„ÙŠÙˆØªÙŠÙˆØ¨
        document.getElementById('player-container').innerHTML = '<div id="yt-player"></div>';
        player = null; 
    }

    // --- Ù†Ø¸Ø§Ù… Ø§Ù„ØªÙ„Ø§ÙˆØ© Ø§Ù„ØµÙˆØªÙŠ ---
    function startReading(name, id) {
        const demoWords = ["Ø¨ÙØ³Ù’Ù…Ù", "Ø§Ù„Ù„ÙÙ‘Ù‡Ù", "Ø§Ù„Ø±ÙÙ‘Ø­Ù’Ù…ÙÙ†Ù", "Ø§Ù„Ø±ÙÙ‘Ø­ÙÙŠÙ…Ù", "Ø§Ù„Ù’Ø­ÙÙ…Ù’Ø¯Ù", "Ù„ÙÙ„ÙÙ‘Ù‡Ù", "Ø±ÙØ¨ÙÙ‘", "Ø§Ù„Ù’Ø¹ÙØ§Ù„ÙÙ…ÙÙŠÙ†Ù"];
        document.getElementById('mushaf-content').innerHTML = `<h2>Ø³ÙˆØ±Ø© ${name}</h2>` + 
            demoWords.map((w, i) => `<span class="word" id="w-${i}">${w}</span>`).join(' ');
        
        document.getElementById('audio-title').innerText = "ØªÙ„Ø§ÙˆØ© Ø³ÙˆØ±Ø© " + name;
        document.getElementById('audioBar').style.display = 'flex';
        
        audioEngine.src = `https://www.everyayah.com/data/Hudhaify_64kbps/${id}001.mp3`;
        audioEngine.play();
        document.getElementById('pBtn').innerText = "â¸";
        showView('reading');

        audioEngine.ontimeupdate = () => {
            let pct = (audioEngine.currentTime / audioEngine.duration) * 100;
            document.getElementById('a-prog').style.width = pct + "%";
        };
    }

    function toggleAudio() {
        if(audioEngine.paused) { audioEngine.play(); document.getElementById('pBtn').innerText = "â¸"; }
        else { audioEngine.pause(); document.getElementById('pBtn').innerText = "â–¶"; }
    }

    function exitReading() {
        audioEngine.pause();
        document.getElementById('audioBar').style.display = 'none';
        showView('suras');
    }

    function onYouTubeIframeAPIReady() { }
</script>
</body>
</html>
